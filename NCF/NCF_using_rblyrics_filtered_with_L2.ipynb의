{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":60493,"status":"ok","timestamp":1702314555768,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"},"user_tz":-540},"id":"3P24n8878PJM","outputId":"21606aae-fb1d-404a-d1be-d71c90ce457d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1r96NUUG8Qzq"},"outputs":[],"source":["import pandas as pd\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","import json\n","import pickle"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oNl4DAEQXUI0"},"outputs":[],"source":["df = pd.read_csv('/content/drive/MyDrive/집교 2_Team P/user-track-listen_count_filtered5.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3491,"status":"ok","timestamp":1702314562984,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"},"user_tz":-540},"id":"w4NvBdioNcwc","outputId":"2fd5f61c-1267-471e-d9f5-14bd9f6d33bc"},"outputs":[{"output_type":"stream","name":"stdout","text":["                                           embedding  track_id\n","0  [-0.12158579, -7.7443256e-05, -0.0053676204, -...         2\n","1  [-0.09675782, 0.013993852, -0.015174615, -0.16...         8\n","2  [-0.093518496, -0.0029156643, -0.010224976, -0...      1524\n","3  [-0.093399145, 0.04077526, -0.01454136, -0.175...      1785\n","4  [-0.09469494, -0.010988763, -0.008885505, -0.1...      1787\n"]}],"source":["# Pickle 파일 읽기\n","with open('/content/drive/MyDrive/집교 2_Team P/lyrics_Embedding/all_embeddings_roberta_full.pkl', 'rb') as file:\n","    data = pickle.load(file)\n","\n","# DataFrame으로 변환\n","df_embedding = pd.DataFrame(data, columns=['embedding', 'track_id'])\n","\n","# track_id를 정수로 변환 (필요하다면)\n","df_embedding['track_id'] = df_embedding['track_id'].astype(int)\n","\n","# 'embedding' 열을 768차원의 각 차원으로 나누기\n","# df_embedding[['embedding_{}'.format(i) for i in range(768)]] = pd.DataFrame(df_embedding['embedding'].tolist(), index=df_embedding.index)\n","\n","# 'embedding' 열 삭제\n","# df_embedding = df_embedding.drop(['embedding'], axis=1)\n","\n","# DataFrame 확인\n","print(df_embedding.head())\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1128,"status":"ok","timestamp":1702314564094,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"},"user_tz":-540},"id":"tcgdIxDm26q1","outputId":"65671fa6-6201-4576-854e-feda60c49c20"},"outputs":[{"output_type":"stream","name":"stdout","text":["(4645010, 4)\n"]},{"output_type":"execute_result","data":{"text/plain":["(4644051, 5)"]},"metadata":{},"execution_count":5}],"source":["print(df.shape)\n","df = pd.merge(df, df_embedding, on='track_id', how='inner')\n","df.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9NXSpxBu0gwC"},"outputs":[],"source":["from sklearn.preprocessing import LabelEncoder\n","user_encoder = LabelEncoder()\n","track_encoder = LabelEncoder()\n","lyrics_encoder = LabelEncoder()\n","df['user_id'] = user_encoder.fit_transform(df['user_id'])\n","df['track_id'] = track_encoder.fit_transform(df['track_id'])\n","df_embedding['track_id'] = lyrics_encoder.fit_transform(df_embedding['track_id'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vPRKFW-5UMWu"},"outputs":[],"source":["lyrics_dict = dict(zip(df_embedding['track_id'], df_embedding['embedding']))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16450,"status":"ok","timestamp":1702314581157,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"},"user_tz":-540},"id":"k1fRcTb18Kkm","outputId":"a0b7ab00-9bca-4c77-88db-8a4c87d35083"},"outputs":[{"output_type":"stream","name":"stdout","text":["23761\n","28309\n"]}],"source":["# !pip install torch torchvision -U\n","\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","from torch.utils.data import DataLoader, TensorDataset\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import mean_squared_error\n","import pandas as pd\n","import numpy as np\n","from tqdm import tqdm\n","\n","# 데이터 불러오기 (예시: CSV 파일)\n","# Label Encoding\n","# PyTorch DataLoader에 맞게 데이터 변환\n","def df_to_tensor(dataset):\n","    users = torch.tensor(dataset['user_id'].values, dtype=torch.int)\n","    items = torch.tensor(dataset['track_id'].values, dtype=torch.int)\n","    ratings = torch.tensor(dataset['listen_count_bin'].values, dtype=torch.float)\n","    lyrics_embeddings = torch.tensor(np.vstack(dataset['embedding'].values), dtype=torch.float)\n","    return users, items, ratings, lyrics_embeddings\n","\n","train_df, test_df = train_test_split(df, test_size=0.3, random_state=42)\n","val_df, test_df = train_test_split(test_df,test_size=0.5, random_state=42)\n","\n","train_users, train_items, train_ratings, train_lyrics_embeddings = df_to_tensor(train_df)\n","val_users,val_items,val_ratings,val_lyrics_embeddings = df_to_tensor(val_df)\n","test_users, test_items, test_ratings,test_lyrics_embeddings = df_to_tensor(test_df)\n","\n","\n","train_data = TensorDataset(train_users, train_items, train_ratings,train_lyrics_embeddings)\n","val_data = TensorDataset(val_users,val_items,val_ratings,val_lyrics_embeddings)\n","test_data = TensorDataset(test_users, test_items, test_ratings,test_lyrics_embeddings)\n","\n","train_loader = DataLoader(train_data, batch_size=256, shuffle=True)\n","val_loader = DataLoader(val_data, batch_size=256, shuffle=True)\n","test_loader = DataLoader(test_data, batch_size=256, shuffle=False)\n","num_users = (df['user_id'].nunique())\n","num_items = (df['track_id'].nunique())\n","print(num_users)\n","print(num_items)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1702314581158,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"},"user_tz":-540},"id":"AR2UqD37OG_A","outputId":"ccf0a8d3-de3f-47e0-f51f-0ee45734a977"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using device: cuda\n"]}],"source":["# NCF 모델 정의\n","class NCF_embedding(nn.Module):\n","    def __init__(self, num_users, num_items, embedding_size):\n","        super(NCF_embedding, self).__init__()\n","        self.user_embedding = nn.Embedding(num_users, embedding_size)\n","        self.item_embedding = nn.Embedding(num_items, embedding_size)\n","        self.lyrics_embedding = nn.Linear(768, embedding_size)\n","        self.fc_layers = nn.Sequential(\n","            nn.Linear(embedding_size * 3, embedding_size),\n","            nn.ReLU(),\n","            nn.Linear(embedding_size, int(embedding_size/2)),\n","            nn.ReLU(),\n","            nn.Linear(int(embedding_size/2), int(embedding_size/4)),\n","            nn.ReLU(),\n","            nn.Linear(int(embedding_size/4), int(embedding_size/8)),\n","            nn.ReLU(),\n","            nn.Linear(int(embedding_size/8), 1)\n","        )\n","\n","    def forward(self, user, item, lyrics_embedding):\n","        user_embedding = self.user_embedding(user)\n","        item_embedding = self.item_embedding(item)\n","        lyrics_embedding = self.lyrics_embedding(lyrics_embedding.reshape(lyrics_embedding.shape[0],768))\n","        x = torch.cat((user_embedding, item_embedding,lyrics_embedding), dim=1)\n","        x = self.fc_layers(x)\n","        return x\n","\n","# CUDA 디바이스 설정\n","device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","print('Using device:', device)\n","def train_embedding(embedding,n_epoch):\n","  # NCF 모델 정의 및 GPU로 이동\n","  model = NCF_embedding(num_users=num_users, num_items=num_items, embedding_size=embedding)\n","  model.to(device)\n","  criterion = nn.MSELoss()\n","  optimizer = optim.Adam(model.parameters(), lr=0.001,weight_decay=1e-5)\n","  # tqdm을 사용하여 학습 및 테스트 진행 상황 확인\n","  num_epochs = n_epoch\n","  min_loss = 100\n","  cnt = 0\n","  for epoch in range(num_epochs):\n","      model.train()\n","      total_loss = 0\n","      for user, item, rating,embedding in tqdm(train_loader, desc=f'Epoch {epoch+1}/{num_epochs}'):\n","          optimizer.zero_grad()\n","          user, item, rating,embedding = user.to(device), item.to(device), rating.to(device),embedding.to(device)  # GPU로 이동\n","          output = model(user, item,embedding)\n","          loss = criterion(output, rating.unsqueeze(1))\n","          loss.backward()\n","          optimizer.step()\n","          total_loss += loss.item()\n","\n","      avg_loss = total_loss / len(train_loader)\n","      print(f'Epoch {epoch+1}/{num_epochs}, Avg. Loss: {avg_loss:.4f}')\n","\n","     # Validation\n","      model.eval()\n","      total_val_loss = 0\n","      all_predictions = []\n","      with torch.no_grad():\n","          for user, item, rating, embedding in tqdm(val_loader, desc=f'Validation Epoch {epoch+1}'):\n","              user, item, rating, embedding = user.to(device), item.to(device), rating.to(device), embedding.to(device)  # GPU로 이동\n","              output = model(user, item, embedding)\n","              val_loss = criterion(output, rating.unsqueeze(1))\n","              total_val_loss += val_loss.item()\n","              all_predictions.append(output)\n","\n","      # RMSE 계산\n","      predictions = torch.cat(all_predictions).squeeze().cpu().numpy()  # CPU로 이동 후 numpy로 변환\n","      rmse = np.sqrt(mean_squared_error(val_df['listen_count_bin'].values, predictions))\n","      avg_val_loss = total_val_loss / len(val_loader)\n","      print(f'Validation Epoch {epoch+1}/{num_epochs}, Avg. Loss: {avg_val_loss:.4f}')\n","      print(f'Validation Epoch {epoch+1}/{num_epochs}, RMSE on validation set: {rmse}')\n","      if avg_val_loss < min_loss:\n","          min_loss = avg_val_loss\n","          cnt = 0\n","      else:\n","          cnt += 1\n","      if cnt == 2:\n","        print(\"val_loss did not decrease\")\n","        break\n","\n","  # Test\n","  model.eval()\n","  all_predictions = []\n","  with torch.no_grad():\n","      for user, item, _ , embedding in tqdm(test_loader, desc=f'Testing'):\n","          user, item, embedding = user.to(device), item.to(device), embedding.to(device)  # GPU로 이동\n","          output = model(user, item,embedding)\n","          all_predictions.append(output)\n","\n","  # RMSE 계산\n","  predictions = torch.cat(all_predictions).squeeze().cpu().numpy()  # CPU로 이동 후 numpy로 변환\n","  rmse = np.sqrt(mean_squared_error(test_df['listen_count_bin'].values, predictions))\n","  print(f'Final RMSE on test set: {rmse}')"]},{"cell_type":"code","source":["train_embedding(64,30)"],"metadata":{"id":"bHQjtCGl3pFM","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702316295519,"user_tz":-540,"elapsed":1714364,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"}},"outputId":"7a015840-d1a5-4809-bab0-361b2900212d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Epoch 1/30: 100%|██████████| 12699/12699 [01:26<00:00, 147.02it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/30, Avg. Loss: 1.4214\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 1: 100%|██████████| 2722/2722 [00:14<00:00, 192.02it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 1/30, Avg. Loss: 1.3559\n","Validation Epoch 1/30, RMSE on validation set: 1.3831830324099776\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 2/30: 100%|██████████| 12699/12699 [01:26<00:00, 146.50it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 2/30, Avg. Loss: 1.3532\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 2: 100%|██████████| 2722/2722 [00:14<00:00, 191.93it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 2/30, Avg. Loss: 1.3453\n","Validation Epoch 2/30, RMSE on validation set: 1.3789926128582113\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 3/30: 100%|██████████| 12699/12699 [01:26<00:00, 146.70it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 3/30, Avg. Loss: 1.3321\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 3: 100%|██████████| 2722/2722 [00:13<00:00, 200.07it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 3/30, Avg. Loss: 1.3214\n","Validation Epoch 3/30, RMSE on validation set: 1.4109052308840417\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 4/30: 100%|██████████| 12699/12699 [01:26<00:00, 146.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 4/30, Avg. Loss: 1.2998\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 4: 100%|██████████| 2722/2722 [00:13<00:00, 200.58it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 4/30, Avg. Loss: 1.2958\n","Validation Epoch 4/30, RMSE on validation set: 1.4068681903891183\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 5/30: 100%|██████████| 12699/12699 [01:26<00:00, 146.83it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 5/30, Avg. Loss: 1.2640\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 5: 100%|██████████| 2722/2722 [00:13<00:00, 199.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 5/30, Avg. Loss: 1.2682\n","Validation Epoch 5/30, RMSE on validation set: 1.4274499766338025\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 6/30: 100%|██████████| 12699/12699 [01:26<00:00, 147.33it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 6/30, Avg. Loss: 1.2298\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 6: 100%|██████████| 2722/2722 [00:13<00:00, 201.49it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 6/30, Avg. Loss: 1.2449\n","Validation Epoch 6/30, RMSE on validation set: 1.4406085902013315\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 7/30: 100%|██████████| 12699/12699 [01:25<00:00, 147.70it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 7/30, Avg. Loss: 1.1971\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 7: 100%|██████████| 2722/2722 [00:13<00:00, 195.03it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 7/30, Avg. Loss: 1.2300\n","Validation Epoch 7/30, RMSE on validation set: 1.453273453238816\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 8/30: 100%|██████████| 12699/12699 [01:25<00:00, 148.56it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 8/30, Avg. Loss: 1.1649\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 8: 100%|██████████| 2722/2722 [00:13<00:00, 202.52it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 8/30, Avg. Loss: 1.2059\n","Validation Epoch 8/30, RMSE on validation set: 1.441667566632534\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 9/30: 100%|██████████| 12699/12699 [01:25<00:00, 148.50it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 9/30, Avg. Loss: 1.1345\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 9: 100%|██████████| 2722/2722 [00:13<00:00, 198.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 9/30, Avg. Loss: 1.1907\n","Validation Epoch 9/30, RMSE on validation set: 1.441453134446286\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 10/30: 100%|██████████| 12699/12699 [01:25<00:00, 148.12it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 10/30, Avg. Loss: 1.1077\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 10: 100%|██████████| 2722/2722 [00:13<00:00, 202.39it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 10/30, Avg. Loss: 1.1784\n","Validation Epoch 10/30, RMSE on validation set: 1.458788714692586\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 11/30: 100%|██████████| 12699/12699 [01:25<00:00, 149.07it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 11/30, Avg. Loss: 1.0814\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 11: 100%|██████████| 2722/2722 [00:13<00:00, 200.23it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 11/30, Avg. Loss: 1.1665\n","Validation Epoch 11/30, RMSE on validation set: 1.4687904580346143\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 12/30: 100%|██████████| 12699/12699 [01:25<00:00, 147.69it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 12/30, Avg. Loss: 1.0568\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 12: 100%|██████████| 2722/2722 [00:13<00:00, 202.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 12/30, Avg. Loss: 1.1627\n","Validation Epoch 12/30, RMSE on validation set: 1.4825695574044033\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 13/30: 100%|██████████| 12699/12699 [01:25<00:00, 148.18it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 13/30, Avg. Loss: 1.0342\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 13: 100%|██████████| 2722/2722 [00:13<00:00, 198.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 13/30, Avg. Loss: 1.1522\n","Validation Epoch 13/30, RMSE on validation set: 1.4764996394333774\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 14/30: 100%|██████████| 12699/12699 [01:25<00:00, 147.88it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 14/30, Avg. Loss: 1.0126\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 14: 100%|██████████| 2722/2722 [00:13<00:00, 198.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 14/30, Avg. Loss: 1.1492\n","Validation Epoch 14/30, RMSE on validation set: 1.4819555914713043\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 15/30: 100%|██████████| 12699/12699 [01:26<00:00, 147.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 15/30, Avg. Loss: 0.9926\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 15: 100%|██████████| 2722/2722 [00:13<00:00, 199.01it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 15/30, Avg. Loss: 1.1461\n","Validation Epoch 15/30, RMSE on validation set: 1.492128301731956\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 16/30: 100%|██████████| 12699/12699 [01:25<00:00, 147.77it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 16/30, Avg. Loss: 0.9740\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 16: 100%|██████████| 2722/2722 [00:13<00:00, 202.88it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 16/30, Avg. Loss: 1.1513\n","Validation Epoch 16/30, RMSE on validation set: 1.5124290328212142\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 17/30: 100%|██████████| 12699/12699 [01:25<00:00, 148.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 17/30, Avg. Loss: 0.9577\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 17: 100%|██████████| 2722/2722 [00:13<00:00, 202.21it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 17/30, Avg. Loss: 1.1481\n","Validation Epoch 17/30, RMSE on validation set: 1.5048704553779164\n","val_loss did not decrease\n"]},{"output_type":"stream","name":"stderr","text":["Testing: 100%|██████████| 2722/2722 [00:12<00:00, 212.20it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Final RMSE on test set: 1.070794244474178\n"]}]},{"cell_type":"code","source":["train_embedding(256,30)"],"metadata":{"id":"Af-Cth2Hpmfc","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702318368505,"user_tz":-540,"elapsed":2073007,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"}},"outputId":"97bc0354-5abd-4115-c9c1-1028dd7837dc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Epoch 1/30: 100%|██████████| 12699/12699 [01:31<00:00, 139.32it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/30, Avg. Loss: 1.4146\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 1: 100%|██████████| 2722/2722 [00:13<00:00, 197.11it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 1/30, Avg. Loss: 1.3623\n","Validation Epoch 1/30, RMSE on validation set: 1.3897250445961722\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 2/30: 100%|██████████| 12699/12699 [01:34<00:00, 135.06it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 2/30, Avg. Loss: 1.3499\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 2: 100%|██████████| 2722/2722 [00:13<00:00, 195.56it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 2/30, Avg. Loss: 1.3353\n","Validation Epoch 2/30, RMSE on validation set: 1.3762705536198905\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 3/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.32it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 3/30, Avg. Loss: 1.3166\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 3: 100%|██████████| 2722/2722 [00:13<00:00, 200.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 3/30, Avg. Loss: 1.3083\n","Validation Epoch 3/30, RMSE on validation set: 1.3847646691100033\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 4/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 4/30, Avg. Loss: 1.2795\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 4: 100%|██████████| 2722/2722 [00:13<00:00, 195.60it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 4/30, Avg. Loss: 1.2750\n","Validation Epoch 4/30, RMSE on validation set: 1.3995132703720217\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 5/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 5/30, Avg. Loss: 1.2413\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 5: 100%|██████████| 2722/2722 [00:13<00:00, 197.14it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 5/30, Avg. Loss: 1.2475\n","Validation Epoch 5/30, RMSE on validation set: 1.434013434929318\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 6/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.56it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 6/30, Avg. Loss: 1.2088\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 6: 100%|██████████| 2722/2722 [00:13<00:00, 198.16it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 6/30, Avg. Loss: 1.2363\n","Validation Epoch 6/30, RMSE on validation set: 1.4565487300535498\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 7/30: 100%|██████████| 12699/12699 [01:33<00:00, 135.14it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 7/30, Avg. Loss: 1.1779\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 7: 100%|██████████| 2722/2722 [00:13<00:00, 196.42it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 7/30, Avg. Loss: 1.2114\n","Validation Epoch 7/30, RMSE on validation set: 1.4472814988915623\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 8/30: 100%|██████████| 12699/12699 [01:34<00:00, 133.68it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 8/30, Avg. Loss: 1.1507\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 8: 100%|██████████| 2722/2722 [00:13<00:00, 198.47it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 8/30, Avg. Loss: 1.1956\n","Validation Epoch 8/30, RMSE on validation set: 1.4376697212244556\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 9/30: 100%|██████████| 12699/12699 [01:35<00:00, 133.05it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 9/30, Avg. Loss: 1.1262\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 9: 100%|██████████| 2722/2722 [00:13<00:00, 198.58it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 9/30, Avg. Loss: 1.1854\n","Validation Epoch 9/30, RMSE on validation set: 1.4640776938237117\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 10/30: 100%|██████████| 12699/12699 [01:37<00:00, 129.65it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 10/30, Avg. Loss: 1.1036\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 10: 100%|██████████| 2722/2722 [00:13<00:00, 198.41it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 10/30, Avg. Loss: 1.1728\n","Validation Epoch 10/30, RMSE on validation set: 1.4599263918387204\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 11/30: 100%|██████████| 12699/12699 [01:34<00:00, 133.88it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 11/30, Avg. Loss: 1.0825\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 11: 100%|██████████| 2722/2722 [00:13<00:00, 200.36it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 11/30, Avg. Loss: 1.1728\n","Validation Epoch 11/30, RMSE on validation set: 1.4861297840928394\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 12/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 12/30, Avg. Loss: 1.0634\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 12: 100%|██████████| 2722/2722 [00:13<00:00, 199.46it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 12/30, Avg. Loss: 1.1637\n","Validation Epoch 12/30, RMSE on validation set: 1.4783073035337537\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 13/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.69it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 13/30, Avg. Loss: 1.0449\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 13: 100%|██████████| 2722/2722 [00:13<00:00, 199.78it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 13/30, Avg. Loss: 1.1617\n","Validation Epoch 13/30, RMSE on validation set: 1.4942864288870146\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 14/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 14/30, Avg. Loss: 1.0284\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 14: 100%|██████████| 2722/2722 [00:14<00:00, 194.05it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 14/30, Avg. Loss: 1.1547\n","Validation Epoch 14/30, RMSE on validation set: 1.5010913129192078\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 15/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.78it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 15/30, Avg. Loss: 1.0122\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 15: 100%|██████████| 2722/2722 [00:13<00:00, 198.80it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 15/30, Avg. Loss: 1.1468\n","Validation Epoch 15/30, RMSE on validation set: 1.4923070575889257\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 16/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.40it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 16/30, Avg. Loss: 0.9970\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 16: 100%|██████████| 2722/2722 [00:14<00:00, 192.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 16/30, Avg. Loss: 1.1519\n","Validation Epoch 16/30, RMSE on validation set: 1.4952242100806623\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 17/30: 100%|██████████| 12699/12699 [01:34<00:00, 134.09it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 17/30, Avg. Loss: 0.9835\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 17: 100%|██████████| 2722/2722 [00:13<00:00, 195.02it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 17/30, Avg. Loss: 1.1397\n","Validation Epoch 17/30, RMSE on validation set: 1.4901905598434546\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 18/30: 100%|██████████| 12699/12699 [01:36<00:00, 132.07it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 18/30, Avg. Loss: 0.9700\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 18: 100%|██████████| 2722/2722 [00:13<00:00, 198.44it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 18/30, Avg. Loss: 1.1432\n","Validation Epoch 18/30, RMSE on validation set: 1.508844759165511\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 19/30: 100%|██████████| 12699/12699 [01:35<00:00, 133.41it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 19/30, Avg. Loss: 0.9587\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 19: 100%|██████████| 2722/2722 [00:13<00:00, 201.43it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 19/30, Avg. Loss: 1.1524\n","Validation Epoch 19/30, RMSE on validation set: 1.5246654898411058\n","val_loss did not decrease\n"]},{"output_type":"stream","name":"stderr","text":["Testing: 100%|██████████| 2722/2722 [00:12<00:00, 210.12it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Final RMSE on test set: 1.0716844305626199\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nl-X0TscnyT_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702321676326,"user_tz":-540,"elapsed":3307843,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"}},"outputId":"943d6fe0-1110-4bd0-d2a9-b72ec15de7d6"},"outputs":[{"output_type":"stream","name":"stderr","text":["Epoch 1/30: 100%|██████████| 12699/12699 [01:45<00:00, 120.88it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/30, Avg. Loss: 1.4171\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 1: 100%|██████████| 2722/2722 [00:13<00:00, 196.10it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 1/30, Avg. Loss: 1.3651\n","Validation Epoch 1/30, RMSE on validation set: 1.380478708083994\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 2/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.02it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 2/30, Avg. Loss: 1.3539\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 2: 100%|██████████| 2722/2722 [00:13<00:00, 199.68it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 2/30, Avg. Loss: 1.3392\n","Validation Epoch 2/30, RMSE on validation set: 1.379946468186354\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 3/30: 100%|██████████| 12699/12699 [01:48<00:00, 117.57it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 3/30, Avg. Loss: 1.3295\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 3: 100%|██████████| 2722/2722 [00:13<00:00, 198.74it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 3/30, Avg. Loss: 1.3207\n","Validation Epoch 3/30, RMSE on validation set: 1.3988133415860555\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 4/30: 100%|██████████| 12699/12699 [01:49<00:00, 116.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 4/30, Avg. Loss: 1.3067\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 4: 100%|██████████| 2722/2722 [00:13<00:00, 197.87it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 4/30, Avg. Loss: 1.3056\n","Validation Epoch 4/30, RMSE on validation set: 1.4183884877495476\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 5/30: 100%|██████████| 12699/12699 [01:50<00:00, 114.61it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 5/30, Avg. Loss: 1.2821\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 5: 100%|██████████| 2722/2722 [00:13<00:00, 195.20it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 5/30, Avg. Loss: 1.2837\n","Validation Epoch 5/30, RMSE on validation set: 1.4125289229455005\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 6/30: 100%|██████████| 12699/12699 [01:51<00:00, 114.14it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 6/30, Avg. Loss: 1.2560\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 6: 100%|██████████| 2722/2722 [00:13<00:00, 195.93it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 6/30, Avg. Loss: 1.2637\n","Validation Epoch 6/30, RMSE on validation set: 1.413515230933277\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 7/30: 100%|██████████| 12699/12699 [01:51<00:00, 114.34it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 7/30, Avg. Loss: 1.2333\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 7: 100%|██████████| 2722/2722 [00:14<00:00, 193.71it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 7/30, Avg. Loss: 1.2618\n","Validation Epoch 7/30, RMSE on validation set: 1.3982869084671763\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 8/30: 100%|██████████| 12699/12699 [01:50<00:00, 114.81it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 8/30, Avg. Loss: 1.2120\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 8: 100%|██████████| 2722/2722 [00:13<00:00, 198.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 8/30, Avg. Loss: 1.2426\n","Validation Epoch 8/30, RMSE on validation set: 1.4300001005005056\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 9/30: 100%|██████████| 12699/12699 [01:49<00:00, 116.26it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 9/30, Avg. Loss: 1.1921\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 9: 100%|██████████| 2722/2722 [00:13<00:00, 195.16it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 9/30, Avg. Loss: 1.2343\n","Validation Epoch 9/30, RMSE on validation set: 1.4221075834784462\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 10/30: 100%|██████████| 12699/12699 [01:48<00:00, 117.18it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 10/30, Avg. Loss: 1.1742\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 10: 100%|██████████| 2722/2722 [00:13<00:00, 201.50it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 10/30, Avg. Loss: 1.2138\n","Validation Epoch 10/30, RMSE on validation set: 1.4481895949019026\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 11/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.99it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 11/30, Avg. Loss: 1.1565\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 11: 100%|██████████| 2722/2722 [00:13<00:00, 199.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 11/30, Avg. Loss: 1.2067\n","Validation Epoch 11/30, RMSE on validation set: 1.4423437708584403\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 12/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.13it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 12/30, Avg. Loss: 1.1402\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 12: 100%|██████████| 2722/2722 [00:13<00:00, 198.71it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 12/30, Avg. Loss: 1.1969\n","Validation Epoch 12/30, RMSE on validation set: 1.4573572087844602\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 13/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.61it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 13/30, Avg. Loss: 1.1247\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 13: 100%|██████████| 2722/2722 [00:13<00:00, 199.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 13/30, Avg. Loss: 1.1937\n","Validation Epoch 13/30, RMSE on validation set: 1.4636641034395879\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 14/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.62it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 14/30, Avg. Loss: 1.1101\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 14: 100%|██████████| 2722/2722 [00:13<00:00, 197.11it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 14/30, Avg. Loss: 1.1911\n","Validation Epoch 14/30, RMSE on validation set: 1.4717489321548787\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 15/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.76it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 15/30, Avg. Loss: 1.0958\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 15: 100%|██████████| 2722/2722 [00:13<00:00, 200.84it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 15/30, Avg. Loss: 1.1905\n","Validation Epoch 15/30, RMSE on validation set: 1.4825399641747938\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 16/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.07it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 16/30, Avg. Loss: 1.0826\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 16: 100%|██████████| 2722/2722 [00:13<00:00, 196.38it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 16/30, Avg. Loss: 1.1745\n","Validation Epoch 16/30, RMSE on validation set: 1.4660648576814963\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 17/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.25it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 17/30, Avg. Loss: 1.0692\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 17: 100%|██████████| 2722/2722 [00:13<00:00, 201.66it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 17/30, Avg. Loss: 1.1768\n","Validation Epoch 17/30, RMSE on validation set: 1.482088222874681\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 18/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.01it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 18/30, Avg. Loss: 1.0574\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 18: 100%|██████████| 2722/2722 [00:13<00:00, 199.64it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 18/30, Avg. Loss: 1.1698\n","Validation Epoch 18/30, RMSE on validation set: 1.4591162534146707\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 19/30: 100%|██████████| 12699/12699 [01:48<00:00, 117.20it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 19/30, Avg. Loss: 1.0458\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 19: 100%|██████████| 2722/2722 [00:13<00:00, 199.64it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 19/30, Avg. Loss: 1.1682\n","Validation Epoch 19/30, RMSE on validation set: 1.4825490944607334\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 20/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.11it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 20/30, Avg. Loss: 1.0348\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 20: 100%|██████████| 2722/2722 [00:13<00:00, 200.70it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 20/30, Avg. Loss: 1.1669\n","Validation Epoch 20/30, RMSE on validation set: 1.5004863011766953\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 21/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.64it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 21/30, Avg. Loss: 1.0244\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 21: 100%|██████████| 2722/2722 [00:13<00:00, 201.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 21/30, Avg. Loss: 1.1571\n","Validation Epoch 21/30, RMSE on validation set: 1.4847113828098162\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 22/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.75it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 22/30, Avg. Loss: 1.0152\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 22: 100%|██████████| 2722/2722 [00:13<00:00, 195.13it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 22/30, Avg. Loss: 1.1580\n","Validation Epoch 22/30, RMSE on validation set: 1.4897659921283763\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 23/30: 100%|██████████| 12699/12699 [01:48<00:00, 117.28it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 23/30, Avg. Loss: 1.0069\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 23: 100%|██████████| 2722/2722 [00:13<00:00, 198.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 23/30, Avg. Loss: 1.1559\n","Validation Epoch 23/30, RMSE on validation set: 1.4915656534440698\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 24/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.17it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 24/30, Avg. Loss: 0.9986\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 24: 100%|██████████| 2722/2722 [00:14<00:00, 194.23it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 24/30, Avg. Loss: 1.1593\n","Validation Epoch 24/30, RMSE on validation set: 1.4771346937654783\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 25/30: 100%|██████████| 12699/12699 [01:48<00:00, 117.23it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 25/30, Avg. Loss: 0.9919\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 25: 100%|██████████| 2722/2722 [00:13<00:00, 201.31it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 25/30, Avg. Loss: 1.1522\n","Validation Epoch 25/30, RMSE on validation set: 1.4885030069267569\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 26/30: 100%|██████████| 12699/12699 [01:47<00:00, 118.10it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 26/30, Avg. Loss: 0.9853\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 26: 100%|██████████| 2722/2722 [00:13<00:00, 197.00it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 26/30, Avg. Loss: 1.1555\n","Validation Epoch 26/30, RMSE on validation set: 1.4992805229379862\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 27/30: 100%|██████████| 12699/12699 [01:47<00:00, 117.94it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 27/30, Avg. Loss: 0.9790\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 27: 100%|██████████| 2722/2722 [00:13<00:00, 200.77it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 27/30, Avg. Loss: 1.1611\n","Validation Epoch 27/30, RMSE on validation set: 1.5111357614415954\n","val_loss did not decrease\n"]},{"output_type":"stream","name":"stderr","text":["Testing: 100%|██████████| 2722/2722 [00:13<00:00, 208.97it/s]"]},{"output_type":"stream","name":"stdout","text":["Final RMSE on test set: 1.0773150393101423\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["train_embedding(512,30)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R4QaOAKJGOzS","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702324544148,"user_tz":-540,"elapsed":2867843,"user":{"displayName":"choi yoonseo","userId":"04452168922848748562"}},"outputId":"c9931528-0b32-4d76-9c5e-4528aa7cc9d3"},"outputs":[{"output_type":"stream","name":"stderr","text":["Epoch 1/30: 100%|██████████| 12699/12699 [01:58<00:00, 106.89it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/30, Avg. Loss: 1.4160\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 1: 100%|██████████| 2722/2722 [00:13<00:00, 195.41it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 1/30, Avg. Loss: 1.3645\n","Validation Epoch 1/30, RMSE on validation set: 1.3757324755127092\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 2/30: 100%|██████████| 12699/12699 [02:01<00:00, 104.32it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 2/30, Avg. Loss: 1.3546\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 2: 100%|██████████| 2722/2722 [00:13<00:00, 196.10it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 2/30, Avg. Loss: 1.3428\n","Validation Epoch 2/30, RMSE on validation set: 1.3833256067835364\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 3/30: 100%|██████████| 12699/12699 [02:01<00:00, 104.33it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 3/30, Avg. Loss: 1.3329\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 3: 100%|██████████| 2722/2722 [00:13<00:00, 196.51it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 3/30, Avg. Loss: 1.3249\n","Validation Epoch 3/30, RMSE on validation set: 1.4010142001748418\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 4/30: 100%|██████████| 12699/12699 [02:02<00:00, 104.01it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 4/30, Avg. Loss: 1.3135\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 4: 100%|██████████| 2722/2722 [00:13<00:00, 200.13it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 4/30, Avg. Loss: 1.3093\n","Validation Epoch 4/30, RMSE on validation set: 1.3903785255868466\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 5/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.92it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 5/30, Avg. Loss: 1.2965\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 5: 100%|██████████| 2722/2722 [00:13<00:00, 200.00it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 5/30, Avg. Loss: 1.3033\n","Validation Epoch 5/30, RMSE on validation set: 1.3866323103435225\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 6/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.87it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 6/30, Avg. Loss: 1.2810\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 6: 100%|██████████| 2722/2722 [00:13<00:00, 195.32it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 6/30, Avg. Loss: 1.2892\n","Validation Epoch 6/30, RMSE on validation set: 1.4049335241545742\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 7/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.78it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 7/30, Avg. Loss: 1.2656\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 7: 100%|██████████| 2722/2722 [00:13<00:00, 195.80it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 7/30, Avg. Loss: 1.2760\n","Validation Epoch 7/30, RMSE on validation set: 1.4239870140549429\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 8/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.76it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 8/30, Avg. Loss: 1.2495\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 8: 100%|██████████| 2722/2722 [00:13<00:00, 197.55it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 8/30, Avg. Loss: 1.2693\n","Validation Epoch 8/30, RMSE on validation set: 1.4277282131962932\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 9/30: 100%|██████████| 12699/12699 [02:02<00:00, 104.01it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 9/30, Avg. Loss: 1.2350\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 9: 100%|██████████| 2722/2722 [00:13<00:00, 199.03it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 9/30, Avg. Loss: 1.2571\n","Validation Epoch 9/30, RMSE on validation set: 1.4238964080830803\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 10/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.46it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 10/30, Avg. Loss: 1.2224\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 10: 100%|██████████| 2722/2722 [00:13<00:00, 196.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 10/30, Avg. Loss: 1.2535\n","Validation Epoch 10/30, RMSE on validation set: 1.4178864207878121\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 11/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.94it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 11/30, Avg. Loss: 1.2115\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 11: 100%|██████████| 2722/2722 [00:13<00:00, 199.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 11/30, Avg. Loss: 1.2509\n","Validation Epoch 11/30, RMSE on validation set: 1.4175682715112874\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 12/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.64it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 12/30, Avg. Loss: 1.2015\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 12: 100%|██████████| 2722/2722 [00:13<00:00, 197.25it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 12/30, Avg. Loss: 1.2456\n","Validation Epoch 12/30, RMSE on validation set: 1.4311749639978506\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 13/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.45it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 13/30, Avg. Loss: 1.1910\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 13: 100%|██████████| 2722/2722 [00:13<00:00, 197.96it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 13/30, Avg. Loss: 1.2411\n","Validation Epoch 13/30, RMSE on validation set: 1.4390834761765487\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 14/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.69it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 14/30, Avg. Loss: 1.1803\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 14: 100%|██████████| 2722/2722 [00:13<00:00, 198.62it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 14/30, Avg. Loss: 1.2352\n","Validation Epoch 14/30, RMSE on validation set: 1.4525672681130493\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 15/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.85it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 15/30, Avg. Loss: 1.1683\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 15: 100%|██████████| 2722/2722 [00:13<00:00, 200.08it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 15/30, Avg. Loss: 1.2325\n","Validation Epoch 15/30, RMSE on validation set: 1.4581633167303076\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 16/30: 100%|██████████| 12699/12699 [02:03<00:00, 103.19it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 16/30, Avg. Loss: 1.1556\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 16: 100%|██████████| 2722/2722 [00:13<00:00, 197.46it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 16/30, Avg. Loss: 1.2159\n","Validation Epoch 16/30, RMSE on validation set: 1.4441185626382407\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 17/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.81it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 17/30, Avg. Loss: 1.1438\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 17: 100%|██████████| 2722/2722 [00:13<00:00, 197.94it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 17/30, Avg. Loss: 1.2153\n","Validation Epoch 17/30, RMSE on validation set: 1.4389387602289194\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 18/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.94it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 18/30, Avg. Loss: 1.1320\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 18: 100%|██████████| 2722/2722 [00:13<00:00, 198.11it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 18/30, Avg. Loss: 1.2087\n","Validation Epoch 18/30, RMSE on validation set: 1.4493752322507898\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 19/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 19/30, Avg. Loss: 1.1211\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 19: 100%|██████████| 2722/2722 [00:13<00:00, 199.49it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 19/30, Avg. Loss: 1.2017\n","Validation Epoch 19/30, RMSE on validation set: 1.4552852690995384\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 20/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.83it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 20/30, Avg. Loss: 1.1117\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 20: 100%|██████████| 2722/2722 [00:13<00:00, 197.61it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 20/30, Avg. Loss: 1.2026\n","Validation Epoch 20/30, RMSE on validation set: 1.4466643402055555\n"]},{"output_type":"stream","name":"stderr","text":["Epoch 21/30: 100%|██████████| 12699/12699 [02:02<00:00, 103.89it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 21/30, Avg. Loss: 1.1023\n"]},{"output_type":"stream","name":"stderr","text":["Validation Epoch 21: 100%|██████████| 2722/2722 [00:13<00:00, 198.35it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Validation Epoch 21/30, Avg. Loss: 1.2034\n","Validation Epoch 21/30, RMSE on validation set: 1.4799679418677498\n","val_loss did not decrease\n"]},{"output_type":"stream","name":"stderr","text":["Testing: 100%|██████████| 2722/2722 [00:12<00:00, 209.90it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Final RMSE on test set: 1.0960674880400476\n"]}],"source":["train_embedding(768,30)"]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[],"gpuType":"A100"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}